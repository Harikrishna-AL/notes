<!doctype html>
<html lang="en-us">
  <head>
    <title>Diffusion // Notes</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.111.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="@harikrishna-al" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/notes/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Diffusion"/>
<meta name="twitter:description" content="Denoising Diffusion Probablistic Models This note is about the diffusion model. It will cover about it&rsquo;s working and implementation both mathematically and code wise. Diffusion is one of the latest techniques used to generate new images by basically destroy them by adding more and more noise. So a basic diffusion model will contain a noise scheduler, a neural network to predict the noise in an image at given timestamp (t) (U-Net is this case) and a loss function which enables the model to learn from dataset."/>

    <meta property="og:title" content="Diffusion" />
<meta property="og:description" content="Denoising Diffusion Probablistic Models This note is about the diffusion model. It will cover about it&rsquo;s working and implementation both mathematically and code wise. Diffusion is one of the latest techniques used to generate new images by basically destroy them by adding more and more noise. So a basic diffusion model will contain a noise scheduler, a neural network to predict the noise in an image at given timestamp (t) (U-Net is this case) and a loss function which enables the model to learn from dataset." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://harikrishna-al.github.io/notes/posts/diffusion/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-21T22:39:12+05:30" />
<meta property="article:modified_time" content="2023-02-21T22:39:12+05:30" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://harikrishna-al.github.io/notes/"><img class="app-header-avatar" src="https://avatars.githubusercontent.com/u/91690484?v=4" alt="@harikrishna-al" /></a>
      <span class="app-header-title">Notes</span>
      <p>This is what I try to learn.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/Harikrishna-AL" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>GitHub</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com/HarikrishnaPi10" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Diffusion</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 21, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="denoising-diffusion-probablistic-models"><strong>Denoising Diffusion Probablistic Models</strong></h1>
<p>This note is about the diffusion model. It will cover about it&rsquo;s working and implementation both mathematically and code wise. Diffusion is one of the latest techniques used to generate new images by basically destroy them by adding more and more noise. So a basic diffusion model will contain a noise scheduler, a neural network to predict the noise in an image at given timestamp (t) (U-Net is this case) and a loss function which enables the model to learn from dataset.</p>
<ul>
<li>
<h2 id="noise-scheduler-forward-diffusion">Noise Scheduler (Forward Diffusion)</h2>
<p>The job of the noise scheduler is to add noise into the image during different timestamps by increasing it in a linear, quadratic and other fashions. We&rsquo;ll be using linear in our case.
This adds noise to the image keeping mean as <em><strong>sqrt(1 - beeta)</strong></em> and variance as <em><strong>beeta</strong></em>. This can be seen similar to a markov chain as the noise in the image at <em>t</em>  depends on the pixels of the image on time <em>t - 1</em>.</p>
<!-- raw HTML omitted -->
<p>This diagram shows the diffusion process. It&rsquo;s a chain process that adds noise step by step till the image is completely destroyed and is dependent on the parameter <!-- raw HTML omitted --><!-- raw HTML omitted -->β<!-- raw HTML omitted --><!-- raw HTML omitted --> and α = 1 - <!-- raw HTML omitted --><!-- raw HTML omitted -->β<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>This formula gives the image at time t given the image at time t=0. The parameters here are the cumilative sum of the parameters till time t.</p>
</li>
<li>
<h2 id="reverse-diffusion">Reverse Diffusion</h2>
<p>Now we need a neural network to predict the noise in a given image at particular timestamp t. We&rsquo;ll be using U-Net because it has the ability to use the information in the previous adjacent latent space. This gives the network attention and makes it possible to predict noise. The model is also given the timestamp as input by converitng it into a time embedding and adding it to different stages of the model.</p>
</li>
<li>
<h2 id="training">Training</h2>
</li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
